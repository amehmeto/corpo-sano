"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getOperationAndFragments = void 0;
const graphql_1 = require("graphql");
function getOperationAndFragments(document, operationName) {
    let operation;
    const fragmentMap = new Map();
    document.definitions.forEach((definition) => {
        switch (definition.kind) {
            case graphql_1.Kind.OPERATION_DEFINITION:
                if (!operationName && operation) {
                    throw new graphql_1.GraphQLError('Must provide operation name if query contains ' +
                        'multiple operations.');
                }
                if (!operationName ||
                    (definition.name && definition.name.value === operationName)) {
                    operation = definition;
                }
                break;
            case graphql_1.Kind.FRAGMENT_DEFINITION:
                fragmentMap.set(definition.name.value, definition);
                break;
        }
    });
    if (!operation) {
        if (operationName) {
            throw new graphql_1.GraphQLError(`Unknown operation named "${operationName}".`);
        }
        else {
            throw new graphql_1.GraphQLError('Must provide an operation.');
        }
    }
    return { operation, fragmentMap };
}
exports.getOperationAndFragments = getOperationAndFragments;
//# sourceMappingURL=getOperationAndFragments.js.map